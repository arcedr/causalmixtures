<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>gBKMR_method_overview • causalmixtures</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="gBKMR_method_overview">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">causalmixtures</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>

  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    BKMR-CMA

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/BKMRCMA_method_overview.html">Overview of Methodology</a>
    </li>
    <li>
      <a href="../articles/BKMRCMA_QuickStart.html">Quick Start Example - continuous M and continuous Y</a>
    </li>
    <li>
      <a href="../articles/bkmrcma_example_scenario2.html">Example 2 - binary M and binary Y</a>
    </li>
    <li>
      <a href="../articles/bkmrcma_example_scenario3.html">Example 3 - binary M and continuous Y</a>
    </li>
    <li>
      <a href="../articles/bkmrcma_example_scenario4.html">Example 4 - continuous M and binary Y</a>
    </li>
    <li>
      <a href="../articles/BKMRCMA_Effectof_singleZ.html">Effect estimates when Effect Modifier is fixed</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    BKMR-MI

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/BKMRMI_method_overview.html">Overview of Methodology</a>
    </li>
    <li>
      <a href="../articles/MI_BKMR.html">Quick Start</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>

    Functions
  </a>
</li>
<li>
  <a href="https://arcedr.github.io/causalmixtures/">
    <span class="fa fa-github fa-lg"></span>

    Github
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>gBKMR_method_overview</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/zc2326/causalbkmr/blob/HEAD/vignettes/gBKMR_method_overview.Rmd" class="external-link"><code>vignettes/gBKMR_method_overview.Rmd</code></a></small>
      <div class="hidden name"><code>gBKMR_method_overview.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/zc2326/causalbkmr" class="external-link">causalbkmr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Registered S3 method overwritten by 'future':</span></span>
<span><span class="co">#&gt;   method               from      </span></span>
<span><span class="co">#&gt;   all.equal.connection parallelly</span></span></code></pre></div>
<div class="section level2">
<h2 id="causal-estimands">Causal Estimands<a class="anchor" aria-label="anchor" href="#causal-estimands"></a>
</h2>
<p>We consider a setting in which
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
subjects, labelled
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">i = 1, ..., n</annotation></semantics></math>,
enter a study at baseline (time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t=0</annotation></semantics></math>)
and are subjected to treatment
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">A_{0, i}</annotation></semantics></math>.
In a clinical trial, the value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">A_{0, i}</annotation></semantics></math>
is determined by the study protocol, usually at random. In an
observational study,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">A_{0, i}</annotation></semantics></math>
is observed and recorded. A collection of covariates,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">C_{0, i}</annotation></semantics></math>,
are also measured at baseline. At the subsequent follow-up visits, the
time-varying confounders,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>L</mi><mrow><mi>t</mi><mo>,</mo><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">L_{t, i}</annotation></semantics></math>
and treatment
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mrow><mi>t</mi><mo>,</mo><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">A_{t, i}</annotation></semantics></math>
are recorded,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mi>T</mi></mrow><annotation encoding="application/x-tex">t = 1, ..., T</annotation></semantics></math>.
An outcome
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mi>i</mi></msub><annotation encoding="application/x-tex">Y_i</annotation></semantics></math>
is observed for each subject, measured at the final visit
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mi>i</mi></msub><annotation encoding="application/x-tex">Y_i</annotation></semantics></math>
can be continuous or binary.</p>
<p>Along with the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mi>i</mi></msub><annotation encoding="application/x-tex">Y_i</annotation></semantics></math>
for each subject, for each possible realization of the treatment history
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>a</mi><mo accent="true">‾</mo></mover><mo>∈</mo><mover><mi>𝒜</mi><mo accent="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\bar{a} \in \bar{\mathcal{A}}</annotation></semantics></math>;
we also define
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>Y</mi><mi>i</mi><mover><mi>a</mi><mo accent="true">‾</mo></mover></msubsup><annotation encoding="application/x-tex">Y_i^{\bar{a}}</annotation></semantics></math>,
the that would have been observed had the subject, possibly contrary to
fact, received treatment history
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>a</mi><mo accent="true">‾</mo></mover><annotation encoding="application/x-tex">\bar{a}</annotation></semantics></math>.</p>
<p>In a simple setting with 3 visits, assume the following DAG. Under
the static, fixed treatment regimes, the overall causal effect of the
exposures changing form the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mn>25</mn><mrow><mi>t</mi><mi>h</mi></mrow></msup><annotation encoding="application/x-tex">25^{th}</annotation></semantics></math>
percentile to the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mn>75</mn><mrow><mi>t</mi><mi>h</mi></mrow></msup><annotation encoding="application/x-tex">75^{th}</annotation></semantics></math>
percentile can be defined as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>C</mi><mi>E</mi><mo>=</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><msup><mi>Y</mi><mrow><msub><mi>A</mi><mn>0</mn></msub><mo>=</mo><msubsup><mi>a</mi><mn>0</mn><mo>*</mo></msubsup><mo>,</mo><msub><mi>A</mi><mn>1</mn></msub><mo>=</mo><msubsup><mi>a</mi><mn>1</mn><mo>*</mo></msubsup><mo>,</mo><msub><mi>A</mi><mn>2</mn></msub><mo>=</mo><msubsup><mi>a</mi><mn>2</mn><mo>*</mo></msubsup></mrow></msup><mo stretchy="true" form="postfix">]</mo></mrow><mo>−</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><msup><mi>Y</mi><mrow><msub><mi>A</mi><mn>0</mn></msub><mo>=</mo><msub><mi>a</mi><mn>0</mn></msub><mo>,</mo><msub><mi>A</mi><mn>1</mn></msub><mo>=</mo><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>A</mi><mn>2</mn></msub><mo>=</mo><msub><mi>a</mi><mn>2</mn></msub></mrow></msup><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">ACE = E[Y^{A_0 = a_0^*, A_1 = a_1^*, A_2 = a_2^*}] - E[Y^{A_0 = a_0, A_1 = a_1, A_2 = a_2}]</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>0</mn></msub><mo>,</mo><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">a_0, a_1, a_2</annotation></semantics></math>
are the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mn>25</mn><mrow><mi>t</mi><mi>h</mi></mrow></msup><annotation encoding="application/x-tex">25^{th}</annotation></semantics></math>
percentile of the exposures,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>a</mi><mn>0</mn><mo>*</mo></msubsup><mo>,</mo><msubsup><mi>a</mi><mn>1</mn><mo>*</mo></msubsup><mo>,</mo><msubsup><mi>a</mi><mn>2</mn><mo>*</mo></msubsup></mrow><annotation encoding="application/x-tex">a_0^*, a_1^*, a_2^*</annotation></semantics></math>
are the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mn>75</mn><mrow><mi>t</mi><mi>h</mi></mrow></msup><annotation encoding="application/x-tex">75^{th}</annotation></semantics></math>
percentile of the exposures.</p>
<center>
<img src="gbkmrdag.png" width="240">
</center>
</div>
<div class="section level2">
<h2 id="g-formula">g-formula<a class="anchor" aria-label="anchor" href="#g-formula"></a>
</h2>
<p>The basic idea of g-formula is standardization, a common approach to
estimating the expected value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Y</mi><mover><mi>a</mi><mo accent="true">‾</mo></mover></msup><annotation encoding="application/x-tex">Y^{\bar{a}}</annotation></semantics></math>
in the population. (Naimai, Ashley I., et al., 2017) It can be
illustrated in a simple time-fixed confounding example where there are
only baseline confounders
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>0</mn></msub><annotation encoding="application/x-tex">C_0</annotation></semantics></math>
where the sum is over all possible values
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mn>0</mn></msub><annotation encoding="application/x-tex">c_0</annotation></semantics></math>
of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>0</mn></msub><annotation encoding="application/x-tex">C_0</annotation></semantics></math>.
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>Y</mi><mover><mi>a</mi><mo accent="true">‾</mo></mover></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munder><mo>∑</mo><msub><mi>C</mi><mn>0</mn></msub></munder><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo>∣</mo><mover><mi>A</mi><mo accent="true">‾</mo></mover><mo>=</mo><mover><mi>a</mi><mo accent="true">‾</mo></mover><mo>,</mo><msub><mi>C</mi><mn>0</mn></msub><mo>=</mo><msub><mi>c</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>C</mi><mn>0</mn></msub><mo>=</mo><msub><mi>c</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">E\left(Y^{\bar{a}}\right)=\sum_{C_{0}  } E\left(Y \mid \bar{A}=\bar{a}, C_{0}=c_{0}\right) P\left(C_{0}=c_{0}\right)</annotation></semantics></math>
where the sum is over all possible values
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mn>0</mn></msub><annotation encoding="application/x-tex">c_0</annotation></semantics></math>
of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>0</mn></msub><annotation encoding="application/x-tex">C_0</annotation></semantics></math>.\</p>
<p>Using the above DAG, we now define 3 identifying assumptions:\</p>
<ol style="list-style-type: decimal">
<li><p>Consistency:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>A</mi><mn>0</mn></msub><mo>=</mo><msub><mi>a</mi><mn>0</mn></msub><mo>,</mo><msub><mi>A</mi><mn>1</mn></msub><mo>=</mo><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>A</mi><mn>2</mn></msub><mo>=</mo><msub><mi>a</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><msup><mi>Y</mi><mrow><msub><mi>a</mi><mn>0</mn></msub><mo>,</mo><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mn>2</mn></msub></mrow></msup><mo stretchy="false" form="prefix">|</mo><msub><mi>A</mi><mn>0</mn></msub><mo>=</mo><msub><mi>a</mi><mn>0</mn></msub><mo>,</mo><msub><mi>A</mi><mn>1</mn></msub><mo>=</mo><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>A</mi><mn>2</mn></msub><mo>=</mo><msub><mi>a</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">E[Y | A_0 = a_0, A_1 = a_1, A_2 = a_2] = E[Y^{a_0, a_1, a_2}| A_0 = a_0, A_1 = a_1, A_2 = a_2]</annotation></semantics></math></p></li>
<li><p>Exchangeability:<br></p></li>
<li><p>Positivity:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>a</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>l</mi><mi>t</mi></msub><mo>,</mo><msub><mi>c</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>&gt;</mo><mn>0</mn><mspace width="0.222em"></mspace><mtext mathvariant="normal">for all values of</mtext><mspace width="0.222em"></mspace><mi>l</mi><mspace width="0.222em"></mspace><mtext mathvariant="normal">with</mtext><mspace width="0.222em"></mspace><mi>P</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>L</mi><mo>=</mo><mi>l</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>≠</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">Pr(a_t|a_{t-1}, l_t, c_0) &gt; 0 \ \text{for all values of} \ l \  \text{with} \  Pr(L = l) \ne 0 </annotation></semantics></math></p></li>
</ol>
<p>The general expression of the g-formula for a static fixed
intervention is:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><msup><mi>Y</mi><mover><mi>a</mi><mo accent="true">‾</mo></mover></msup><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><munder><mo>∑</mo><mover><mi>l</mi><mo accent="true">‾</mo></mover></munder><mi mathvariant="normal">E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mo>∣</mo><mover><mi>A</mi><mo accent="true">‾</mo></mover><mo>=</mo><mover><mi>a</mi><mo accent="true">‾</mo></mover><mo>,</mo><mover><mi>L</mi><mo accent="true">‾</mo></mover><mo>=</mo><mover><mi>l</mi><mo accent="true">‾</mo></mover><mo>,</mo><msub><mi>C</mi><mn>0</mn></msub><mo>=</mo><msub><mi>c</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">]</mo></mrow><munderover><mo>∏</mo><mrow><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mi>T</mi></munderover><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>l</mi><mi>t</mi></msub><mo>∣</mo><msub><mover><mi>a</mi><mo accent="true">‾</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mover><mi>l</mi><mo accent="true">‾</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">\begin{equation}
E[Y^{\bar{a}}]= \sum_{\bar{l}} \mathrm{E}[Y \mid \bar{A}=\bar{a}, \bar{L}=\bar{l}, C_0 = c_0] \prod_{t=0}^{T} f\left(l_{t} \mid \bar{a}_{t-1}, \bar{l}_{t-1} \right)f(c_0) 
\end{equation}]
</annotation></semantics></math></p>
</div>
<div class="section level2">
<h2 id="bayesian-kernel-machine-regression">Bayesian kernel machine regression<a class="anchor" aria-label="anchor" href="#bayesian-kernel-machine-regression"></a>
</h2>
<p>We first review Kernel Machine Regression (KMR) as a framework for
estimating the effect of a complex mixture when only a single time point
of exposure is measured. For each subject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">i = 1, ..., n</annotation></semantics></math>,
we assume</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mi>i</mi></msub><mo>=</mo><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐚</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msubsup><mi>𝐜</mi><mi>i</mi><mi mathvariant="normal">T</mi></msubsup><mi>𝛃</mi><mo>+</mo><msub><mi>ϵ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\begin{equation}
    Y_{i}=h\left(\mathbf{a}_{i}\right)+\mathbf{c}_{i}^{\mathrm{T}} \boldsymbol{\beta}+\epsilon_{i}
\end{equation}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝐚</mi><mi>i</mi></msub><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>a</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>a</mi><mrow><mi>i</mi><mi>M</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi mathvariant="normal">T</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{a}_{i}=\left(a_{i 1}, \ldots, a_{i M}\right)^{\mathrm{T}}</annotation></semantics></math>
is a vector of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
exposure variables.</p>
<p>It can be shown that the above model can be expressed as the mixed
model
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>h</mi><mi>i</mi></msub><mo>+</mo><msubsup><mi>𝐜</mi><mi>i</mi><mi>T</mi></msubsup><mi>𝛃</mi><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">y_{i} \sim N\left(h_{i}+\mathbf{c}_{i}^{T} \boldsymbol{\beta}, \sigma^{2}\right)</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐡</mi><mo>≡</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>h</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>h</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi mathvariant="normal">T</mi></msup><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>𝟎</mn><mo>,</mo><mi>τ</mi><mi>𝐊</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{equation}
\mathbf{h} \equiv\left(h_{1}, \ldots, h_{n}\right)^{\mathrm{T}} \sim N(\mathbf{0}, \tau \mathbf{K})    
\end{equation}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐊</mi><annotation encoding="application/x-tex">\mathbf{K}</annotation></semantics></math>
is the kernel matrix, has
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo></mrow><annotation encoding="application/x-tex">(i, j)-</annotation></semantics></math>element
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐚</mi><mi>i</mi></msub><mo>,</mo><msub><mi>𝐚</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">K(\mathbf{a}_{i}, \mathbf{a}_{j})</annotation></semantics></math></p>
<p>There are different choices of the kernel. We focus on the Gaussian
kernel, which flexibly captures a wide range of underlying functional
forms for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>⋅</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">h(\cdot)</annotation></semantics></math>,
although the methods are applicable to a broad choice of kernels. We
assume
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>cor</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>h</mi><mi>i</mi></msub><mo>,</mo><msub><mi>h</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">{</mo><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mi>/</mi><mi>ρ</mi><mo stretchy="true" form="postfix">)</mo></mrow><munderover><mo>∑</mo><mrow><mi>m</mi><mo>=</mo><mn>1</mn></mrow><mi>M</mi></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>a</mi><mrow><mi>i</mi><mi>m</mi></mrow></msub><mo>−</mo><msub><mi>a</mi><mrow><mi>j</mi><mi>m</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">}</mo></mrow></mrow><annotation encoding="application/x-tex">\operatorname{cor}\left(h_{i}, h_{j}\right)=\exp \left\{-(1 / \rho) \sum_{m=1}^{M}\left(a_{i m}-a_{j m}\right)^{2}\right\}</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
is a tuning parameter that regulates the smoothness of the dose-response
function. This assumption implies that two subjects with similar
exposures will have more similar risks
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mi>i</mi></msub><annotation encoding="application/x-tex">a_i</annotation></semantics></math>
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mi>j</mi></msub><annotation encoding="application/x-tex">a_j</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>h</mi><mi>i</mi></msub><annotation encoding="application/x-tex">h_i</annotation></semantics></math>
will be close to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>h</mi><mi>j</mi></msub><annotation encoding="application/x-tex">h_j</annotation></semantics></math>
).</p>
<p><a href="https://academic.oup.com/biostatistics/article/16/3/493/269719" class="external-link">Bobb
et al (2015)</a> presented the Bayesian Kernel Machine Regression (BKMR)
as a framework to estimate the effect of a complex mixture on a health
outcome.</p>
<p>To fit (2), we assume a at prior on the coefficients for the
confounding variables,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mo>∼</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\beta \sim 1</annotation></semantics></math>,
and<br><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>σ</mi><mrow><mo>−</mo><mn>2</mn></mrow></msup><mo>∼</mo><mo>Gamma</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>a</mi><mi>σ</mi></msub><mo>,</mo><msub><mi>b</mi><mi>σ</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\sigma^{-2} \sim \operatorname{Gamma}\left(a_{\sigma}, b_{\sigma}\right)</annotation></semantics></math>,
where we set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>σ</mi></msub><mo>=</mo><msub><mi>b</mi><mi>σ</mi></msub><mo>=</mo><mn>0.001</mn></mrow><annotation encoding="application/x-tex">a_{\sigma} = b_{\sigma} = 0.001</annotation></semantics></math>.</p>
<p>We can parameterize BKMR by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mi>τ</mi><msup><mi>σ</mi><mrow><mo>−</mo><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\lambda=\tau \sigma^{-2}</annotation></semantics></math>,
and we assume a Gamma prior distribution for the variance component of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>.
For the smoothness parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>,
we assume
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>∼</mo><mo>Unif</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\rho \sim \operatorname{Unif}(a, b)</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">a=0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>=</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">b=100</annotation></semantics></math>.
For additional details regarding BKMR and prior specifications, see Bobb
et al. (Bobb et al., <a href="https://academic.oup.com/biostatistics/article/16/3/493/269719" class="external-link">2015</a>,
<a href="https://ehjournal.biomedcentral.com/articles/10.1186/s12940-018-0413-y" class="external-link">2018</a>)</p>
</div>
<div class="section level2">
<h2 id="g-bayesian-kernel-machine-regressiong-bkmr">g-Bayesian kernel machine regression(g-BKMR)<a class="anchor" aria-label="anchor" href="#g-bayesian-kernel-machine-regressiong-bkmr"></a>
</h2>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Anglen Bauer J, Devick KL, Bobb JF, Coull BA, Zoni S, Fedrighi C,
Benedetti C, Guazzetti S, White R, Bellinger D, Yang Q, Webster T,
Wright RO, Smith D, Lucchini R, Claus Henn. Associations from a mixture
of manganese, lead, copper and chromium and adolescent
neurobehavior.</p>
<p>Bobb JF, Claus Henn B, Valeri L, Coull BA. 2018. Statistical software
for analyzing the health effects of multiple concurrent exposures via
Bayesian kernel machine regression. Environ Health 17:67; <a href="doi:10.1186/s12940-018-0413-y" class="uri">doi:10.1186/s12940-018-0413-y</a>.</p>
<p>Bobb JF, Valeri L, Claus Henn B, Christiani DC, Wright RO, Mazumdar
M, et al. 2015. Bayesian kernel machine regression for estimating the
health effects of multi-pollutant mixtures. Biostatistics 16:493–508; <a href="doi:10.1093/biostatistics/kxu058" class="uri">doi:10.1093/biostatistics/kxu058</a>.</p>
<p>Rubin DB. 1987. Multiple imputation for nonresponse in surveys.
Wiley.</p>
<p>Valeri L, Mazumdar M, Bobb J, Claus Henn B, Sharif O, Al. E. 2017.
The joint effect of prenatal exposure to metal mixtures on
neurodevelopmental outcomes at 24 months: evidence from rural
Bangladesh. Env Heal Perspect 125; <a href="doi:DOI" class="uri">doi:DOI</a>: 10.1289/EHP614.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Zilan Chai, Katrina Devick, Arce Domingo, <a href="https://www.lindavaleri.com/" class="external-link">Linda Valeri</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
